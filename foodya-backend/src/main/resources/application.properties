spring.application.name=foodya-backend

server.port=${SERER_PORT}
# ===== ENVIRONMENT VARIABLES IMPORT =====
# Import .env file from project root (one level up from foodya-backend)
spring.config.import=optional:file:../.env[.properties]

# ===== DATABASE CONFIGURATION =====
# Using environment variables for security
spring.datasource.url=${SUPABASE_DB_URL}
spring.datasource.username=${SUPABASE_DB_USER}
spring.datasource.password=${SUPABASE_DB_PASSWORD}

# HikariCP configuration for Supabase
spring.datasource.hikari.data-source-properties.prepareThreshold=0
spring.datasource.hikari.data-source-properties.preparedStatementCacheQueries=0
spring.datasource.hikari.data-source-properties.preparedStatementCacheSize=0

# ===== JPA / HIBERNATE =====
spring.jpa.hibernate.ddl-auto=${HIBERNATE_DDL_AUTO}
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.use_sql_comments=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true
# Dialect will be auto-detected based on database URL

# ===== FLYWAY (disabled) =====
spring.flyway.enabled=false

# ===== SQL INIT =====
spring.sql.init.mode=never
spring.sql.init.continue-on-error=false
spring.jpa.defer-datasource-initialization=true

# ===== JWT CONFIGURATION =====
app.jwt.secret=${JWT_SECRET}
app.jwt.expiration-time=${JWT_EXPIRATION}
app.jwt.refresh-expiration-time=${JWT_REFRESH_EXPIRATION}


# ===== JSON CONFIGURATION =====
# Use ISO 8601 datetime format for better compatibility
# Supports: 2025-12-31T18:44:08 or 2025-12-31T18:44:08.123Z
spring.jackson.time-zone=Asia/Ho_Chi_Minh
spring.jackson.date-format=yyyy-MM-dd'T'HH:mm:ss
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.adjust-dates-to-context-time-zone=true

# ===== SERVER CONFIGURATION =====
server.port=8080

# Security - hide sensitive information in error responses
server.error.include-binding-errors=never
server.error.include-stacktrace=never
server.error.include-exception=false

# ===== LOGGING =====
logging.level.org.springframework.jdbc=${LOG_SPRING_JDBC}
logging.level.org.hibernate.SQL=${LOG_HIBERNATE_SQL}

# ===== SWAGGER / OPENAPI =====
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html

# ===== ACTUATOR (for health checks) =====
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized


